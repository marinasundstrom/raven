import System.*
import System.Console.*
import System.Collections.Generic.*
import System.Text.Json.*
import System.IO.*
import System.Threading.Tasks.*

val builder = WebAppBuilder()
builder.MapPost("/", async (arg: string) -> Task<HttpResult<()>> => {
    await Task.Delay(200)
    return .Created
})

union HttpResult<T> {
    Ok
    Created
    BadRequest
}

class WebAppBuilder {
    public MapPost(path: string, d: Delegate) -> () {
        val invoke = d.Method
        WriteLine("${invoke.Name} -> ${invoke.ReturnType}")
        for param in invoke.GetParameters() {
            WriteLine("${param.Name}: ${param.ParameterType}")     
        }
    }
}

//class HttpContext {}

//delegate RequestDelegate(context: HttpContext) -> Task